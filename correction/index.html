<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="generator" content="Hugo 0.66.0" />
<meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/f8.4/styles/github.min.css">
<link rel="stylesheet" href="../css/normalize.css">
<link rel="stylesheet" href="../css/skeleton.css">
<link rel="stylesheet" href="../css/custom.css">
<link rel="alternate" href="index.xml" type="application/rss+xml" title="Speech Research">
<link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
<title>Enhancing Stability and Fidelity for Zero-shot TTS with A Multi-Level Evaluator - Speech Research</title>
</head>
<body>

<div class="container">

	<header role="banner">
	</header>
	<main role="main">
		<article itemscope itemtype="https://schema.org/BlogPostinCg">
            <h1 class="entry-title" itemprop="headline">Enhancing Stability and Fidelity for Zero-shot TTS with A Multi-Level Evaluator</h1>

			<section itemprop="entry-text">
				<br>

<h2 id="abstract">Abstract</h2>
<p> Recent advances in zero-shot text-to-speech (TTS), driven by language models, diffusion models and masked generation, have achieved impressive naturalness in speech synthesis. Nevertheless, stability and fidelity remain significant challenges, which manifest as mispronunciations, audible noise, and a general degradation in quality. To address these issues, we introduce Vox-Evaluator, a multi-level evaluator designed to guide the correction of erroneous speech segments and preference alignment for TTS systems. It is capable of identifying the temporal boundaries of erroneous segments and providing a holistic quality assessment of the generated speech. Specifically, to refine erroneous segments and enhance the robustness of the zero-shot TTS model, we propose to automatically identify acoustic errors with the evaluator, mask the erroneous segments, and finally regenerate speech conditioning on the correct portions. In addition, the fine-gained information obtained from Vox-Evaluator directly guide the preference alignment, thereby reducing the bad cases in speech synthesize. Due to the lack of suitable training datasets for the Vox-Evaluator, we also construct a synthesized text-speech dataset annotated with fine-grained pronunciation errors or audio quality issues. The experimental results demonstrate the effectiveness of the proposed Vox-Evaluator in enhancing the stability and fidelity of TTS systems through the error correction mechanism and preference optimization. </p>


<h2 id="content">Content</h2>
<b><a href="#model"> Model Overview</a></b><br>
<b><a href="#speech demos"> Speech Demos</a></b><br>
<!-- <a href="#Part 1">Comparison of Different Models</a><br> -->
<!-- <a href="#Part 2">3.2 Comparison of Different Control Conditions</a><br>
<a href="#Part 3">3.3 Comparison of Different Text Conditions</a><br> -->

<h2 id="model"> Model Overview</h2>
<tr>
  <td style="text-align: center"><img src='../figure/model.png'/></td>
</tr>
<p> The multi-level <b>Vox-Evaluator</b> comprising a speech encoder, phoneme tokenizer, unit encoder, timestamp predictor, overall quality score predictor, and a text decoder. It aims to predict the timestamps of faulty speech segments, detect semantic content, and predict a holistic quality score for the entire speech sample.</p>
<p> With the predicted time scope, we then create a speech mask that divides the sequence into parts to be corrected and parts to be preserved. To account for potential inaccuracies in the initial time detection, we apply a small margin to extend temporal masks. This margin is derived by uniformly partitioning the duration of the mismatched text, which guarantees the complete localization and removal of erroneous segments. We refine segment-level speech errors with an editing TTS model that leverage the generated segmentation masks in the speech representation and the text prompt as conditions for the speech generation process, resulting in significantly lower computational costs compared to complete generation.</p>


<!-- <h2 id="metric">2. Evaluation Metrics</h2>
<p> In this section, we introduce evaluation metrics for temporal order, pitch, and energy control: (1) Temporal order control metrics: inspired by the practice in the image field which evaluates the location of generated object using a object detection model, we employ a SED system to provide event-based measures (Eb) and clip-level macro F1 score (At) to assess the temporal order control capability. These metrics evaluate the presence of sound events in the generated audio, as well as the onsets and offsets using the first-place SED system in DCASE 2022 Task 4, <a href="https://github.com/fgnt/pb_sed/">PB-SED</a>, on AudioCondition test set. (2) Pitch control metrics: to compare the distribution of audio pitch, we computed several moments used in the speech field including standard deviation, skewness, and kurtosis as well as the average dynamic time warping distance of the pitch distribution between the ground-truth audio and synthesized audio. (3) Energy control metrics: we compute the MAE between the frame-wise energy extracted from the generated audio and the energy in the ground-truth audio.</p>
<p> The checkpint of PB-SED that we used for evaluating is publicly available <a href="https://zenodo.org/records/10361858">here</a>.</p>
 -->

<h2 id="speech demos"> Speech Demos</h2>
<p> The following parts are the speech samples from our speech correction, erroneous generated, and ground-truth recordings (denoted as GT). We show diverse erroneous segments below: </p>
<!-- <p> <b>Comparison of Different Models</b>: we aim to show that we can generate audio that is more consistent with the ground-truth recordings under the help of control conditions.</p> -->

<div class="big-screen">
<table class="table">
<thead>
<tr>
  <th style="text-align: center">Issue Types</th>
  <th style="text-align: center">Text</th>
  <th style="text-align: center">GT</th>
  <th style="text-align: center">Generated</th>
  <th style="text-align: center">Corrected</th>
</tr>
</thead>
<tbody>


<tr>
  <th style="text-align: center">Repetition</th>
  <td>
    Strategically strategizing strategy in the fast-paced world of e-sports demands a <b>dexterous dexterous dexterous dexterous dexterous dexterous</b> mind.
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/gt/en_seedtts_hard277.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/raw/277.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/correct/277_corrected.wav" type="audio/wav">
    </audio>
  </td>
</tr>

<tr>
  <th style="text-align: center">Repetition</th>
  <td>
    The hypnotic <b>sway sway sway sway sway</b> of the pendulum clock echoed through the dimly lit room, creating an atmosphere of temporal contemplation.
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/gt/en_seedtts_hard380.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/raw/380.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/correct/380_corrected.wav" type="audio/wav">
    </audio>
  </td>
</tr>

<tr>
  <th style="text-align: center">Mispronunciation</th>
  <td>
    To her amazement, she found a supermarket trolley lying on the <b>seabed</b>.
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/gt/common_voice_en_17256676-common_voice_en_17256678.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/raw/common_voice_en_17256676-common_voice_en_17256678_raw.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/correct/common_voice_en_17256678_corrected.wav" type="audio/wav">
    </audio>
  </td>
</tr>

<tr></tr>
  <th style="text-align: center">Mispronunciation</th>
  <td>
    My grandmother has Type One <b>diabetes</b>.
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/gt/common_voice_en_17727889-common_voice_en_17727905.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/raw/common_voice_en_17727905_raw.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/correct/common_voice_en_17727905_corrected.wav" type="audio/wav">
    </audio>
  </td>
</tr>


<tr>
  <th style="text-align: center">Mispronunciation</th>
  <td style="text-align: center">
      
    <br><b>Three seconds</b> before the arrival of JB Hobson's letter, I no more dreamed of chasing the unicorn than of trying for the Northwest Passage.
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/gt/8463-294828-0001.flac" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/raw/8463-294828-0001_raw.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/correct/8463-294828-0001_corrected.wav" type="audio/wav">
    </audio>
  </td>
</tr>



<tr>
  <th style="text-align: center">Delete</th>
  <td style="text-align: center">
    <b>It</b> said that the darkest hour of the night came just before the dawn.
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/gt/common_voice_en_565900-common_voice_en_565902.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/raw/common_voice_en_565900_raw.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/correct/common_voice_en_565902_corrected.wav" type="audio/wav">
    </audio>
  </td>
</tr>

<tr>
  <th style="text-align: center">Punctuation</th>
  <td>
    The Art of <b>/Slash/</b> and \\backslash\\” was the best received talk on modern internet lingo.
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/gt/text_punctuations_115.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/raw/text_punctuations_115.wav.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/correct/text_punctuations_115_corrected.wav" type="audio/wav">
    </audio>
  </td>
</tr>


<tr>
  <th style="text-align: center">Punctuation</th>
  <td>
    The Dead Sea poems contained several annotations, some of which were quite puzzling: <b>[Section unclear]; [Translation</b>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/gt/text_punctuations_117.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/raw/text_punctuations_117.wav.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/correct/text_punctuations_117_corrected.wav" type="audio/wav">
    </audio>
  </td>
</tr>

<tr></tr>
  <th style="text-align: center">Abnormal Pauses</th>
  <td>
    <b>But she clearly doesn't want to?</b>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/gt/text_questions_3.wav.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/raw/text_questions_3_raw.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/correct/text_questions_3_corrected.wav" type="audio/wav">
    </audio>
  </td>
</tr>

<tr>
  <th style="text-align: center">Audible Noise</th>
  <td>
    At the family reunion, my grandfather, or father-in-law for some, told many tongue-in-cheek <b>jokes</b>.
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/gt/text_compound_nouns_41.wav.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/raw/text_compound_nouns_41_raw.wav" type="audio/wav">
    </audio>
  </td>
  <td>
    <audio style="width: 200px;" controls="" preload="none" controls="">
      <source src="../audio/correct/text_compound_nouns_41_corrected.wav" type="audio/wav">
    </audio>
  </td>
</tr>


				
			</section>
		</article>
	</main>

</div>

<script>
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-139981676-1', 'auto');
	ga('send', 'pageview');
</script>

<script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



<script type="text/x-mathjax-config">
     MathJax.Hub.Config({
         HTML: ["input/TeX","output/HTML-CSS"],
         TeX: {
                Macros: {
                         bm: ["\\boldsymbol{#1}", 1],
                         argmax: ["\\mathop{\\rm arg\\,max}\\limits"],
                         argmin: ["\\mathop{\\rm arg\\,min}\\limits"]},
                extensions: ["AMSmath.js","AMSsymbols.js"],
                equationNumbers: { autoNumber: "AMS" } },
         extensions: ["tex2jax.js"],
         jax: ["input/TeX","output/HTML-CSS"],
         tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true },
         "HTML-CSS": { availableFonts: ["TeX"],
                       linebreaks: { automatic: true } }
     });
 </script>

 <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       tex2jax: {
         skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
       }
     });
 </script>

 <script type="text/javascript" async
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
 </script>




</body>
</html>